
$(document).ready(function() {
    $('.marqueCheckbox').click(function() {
        var checkedMarqueIds = $('.marqueCheckbox:checked').map(function() {
            return this.value;
        }).get();
        var permis = $('.marqueCheckboxpermis:checked').map(function() {
            return this.value;
        }).get();

        $.ajax({
            url: '/select_m',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ ids: checkedMarqueIds , permis : permis}),
            success: function(data) {
                generateMotosHTML(data);
            },
            error: function(xhr, textStatus, errorThrown) {
                var motosList = $('#motosList');
                motosList.empty();
                test()
            }
        });
    });
});
$(document).ready(function() {
    $('.marqueCheckboxpermis').click(function() {
        var checkedMarqueIds = $('.marqueCheckbox:checked').map(function() {
            return this.value;
        }).get();
        var permis = $('.marqueCheckboxpermis:checked').map(function() {
            return this.value;
        }).get();

        $.ajax({
            url: '/select_m',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ ids: checkedMarqueIds , permis : permis}),
            success: function(data) {
                generateMotosHTML(data);
            },
            error: function(xhr, textStatus, errorThrown) {
                var motosList = $('#motosList');
                motosList.empty();
                test()
            }
        });
    });
});
const test = () => {
    $.ajax({
        url: '/select_a',
        method: 'POST',
        dataType: 'json',
        success: function(data) {
            generateMotosHTML(data);
        },
        error: function(xhr, textStatus, errorThrown) {
            console.error('Erreur lors de la requête Ajax : ' + textStatus, errorThrown);
        }
    });
}
function generateMotosHTML(motosData) {
    console.log(motosData);
    var motosList = $('#moto_list'); 
    motosList.empty();

    $.each(motosData, function(index, moto) {
        console.log(motosData)
        var col = $('<div>').addClass('col');
        var card = $('<div>').addClass('card mb-3 text-white bg-secondary border-white').appendTo(col);
        var row = $('<div>').addClass('row g-0').appendTo(card);
    
        var imgCol = $('<div>').addClass('col-md-4 my-auto').appendTo(row);
        $('<img>').addClass('img-fluid rounded-start my-auto rounded mx-1')
            .attr('src', 'assets/img/' + moto.motoPicture)
            .attr('alt', moto.motoName)
            .appendTo(imgCol);
    
        var infoCol = $('<div>').addClass('col-md-8').appendTo(row);
        var cardBody = $('<div>').addClass('card-body').appendTo(infoCol);
    
        $('<h5>').addClass('card-title text-center').text(moto.motoName).appendTo(cardBody);
        $('<p>').addClass('card-text text-center').text(moto.marque).appendTo(cardBody);
    
        $('<hr>').addClass('my-1').appendTo(cardBody);
    
        var rowOptionsDesc = $('<div>').addClass('row').appendTo(cardBody);
    
        var colOptions = $('<div>').addClass('col').appendTo(rowOptionsDesc);
        $('<p>').addClass('card-text text-center').text('Option').appendTo(colOptions);
        var optionsList = $('<p>').addClass('card-text').appendTo(colOptions);
        var ulOptions = $('<ul>').appendTo(optionsList);
        moto.motoOption.forEach(function(option) {
            $('<li>').addClass('text_ocass').text(option).appendTo(ulOptions);
        });
    
        var colDesc = $('<div>').addClass('col').appendTo(rowOptionsDesc);
        $('<p>').addClass('card-text text-center').text('Description').appendTo(colDesc);
        $('<p>').addClass('card-text text-center').text(moto.motoDesc).appendTo(colDesc);
    
        $('<hr>').addClass('my-1').appendTo(cardBody);
    
        var rowYearPrice = $('<div>').addClass('row').appendTo(cardBody);
    
        var colYear = $('<div>').addClass('col').appendTo(rowYearPrice);
        $('<p>').addClass('card-text text-center').text(moto.motoYear).appendTo(colYear);
    
        var colPrice = $('<div>').addClass('col').appendTo(rowYearPrice);
        $('<p>').addClass('card-text text-center').text(moto.motoPrice+' €').appendTo(colPrice);
    
        var rowButton = $('<div>').addClass('row mt-1').appendTo(cardBody);
        var linkButton = $('<a>').addClass('card-text text-end').attr('href', '#').appendTo(rowButton);
        $('<button>').addClass('btn btn-outline-dark btn-sm').text('Voir plus... ' + moto.id).appendTo(linkButton);
    
        $('#moto_list').append(col);
    });
    
}



